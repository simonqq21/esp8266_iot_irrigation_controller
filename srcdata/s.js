let gateway=`ws://${window.location.hostname}:5555/ws`;let websocket;let debug=true;let autoEnabled,relayStatus;let timingConfig={timeslots:[0,0,0],duration:0,gmt_offset:8};function initWebSocket(){websocket=new WebSocket(gateway);websocket.onopen=onOpen;websocket.onclose=onClose;websocket.onmessage=onMessage}function onOpen(t){requestStatus()}function onClose(t){setTimeout(initWebSocket,2e3)}function onMessage(t){msg=JSON.parse(t.data);let e=msg["type"];if(debug){console.log(e)}}function isTouchEnabled(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function requestStatus(){let t={type:"status"};websocket.send(JSON.stringify(t))}function requestTimingConfig(){let t={type:"settings"};websocket.send(JSON.stringify(t))}function toggleTimerEnable(){autoEnabled=!autoEnabled;let t={type:"auto",auto_enabled:autoEnabled};if(debug){console.log(t)}websocket.send(JSON.stringify(t))}function updateSettings(){let t;let e;let n;let o={type:"chg_settings",timeslots:t,duration:e,gmt_offset:n};websocket.send(JSON.stringify(o))}function closeRelay(){setRelay(true);setTimeout(setRelay,1e3,false)}function setRelay(t){let e={type:"relay",relay_status:t};console.log(e);websocket.send(JSON.stringify(e))}function clickTimeslot(t){let e=$(t.target);let n=$(e).text();let o=checkTimeslot(parseInt(n));console.log($(clickTimeslot).attr("class"));if("timeBtn"in $(clickTimeslot).attr("class")){if(o){$(e).addClass("enabledBtn");$(e).removeClass("disabledBtn")}else{$(e).addClass("disabledBtn");$(e).removeClass("enabledBtn")}setTimeslot(n,!o)}}function checkTimeslot(t){let e=t/8;let n=t%8;let o=timingConfig.timeslots[e]>>n&1;return o}function loadTimeslot(t){}function loadTimeslots(){for(let t=0;t<24;t++){}}function setTimeslot(t,e){let n=t/8;let o=t%8;let s=1<<o;if(e){timingConfig.timeslots[n]=timingConfig.timeslots[n]|s}else{timingConfig.timeslots[n]=timingConfig.timeslots[n]&!s}}$(document).ready(function(){initWebSocket();$("#masterSwitch").click(function(){toggleTimerEnable()});$("#closeRelayBtn").click(function(){closeRelay()});$(".timeBtn").click(function(t){clickTimeslot(t)});$("#intervalDuration").on("input",function(){});$("#GMTOffset").on("input",function(){setGMTOffset()});$("#saveBtn").click(function(){});setInterval(requestStatus,500);setInterval(requestTimingConfig,1e4)});