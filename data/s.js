let gateway=`ws://${window.location.hostname}:5555/ws`;let websocket;let debug=true;let autoEnabled,relayStatus;let timingConfig={hours:[0,0,0],duration:0,gmt_offset:8};function initWebSocket(){websocket=new WebSocket(gateway);websocket.onopen=onOpen;websocket.onclose=onClose;websocket.onmessage=onMessage}function onOpen(e){requestStatus()}function onClose(e){setTimeout(initWebSocket,2e3)}function onMessage(e){msg=JSON.parse(e.data);let t=msg["type"];if(debug){console.log(t)}}function isTouchEnabled(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function requestStatus(){let e={type:"status"};websocket.send(JSON.stringify(e))}function requestTimingConfig(){let e={type:"settings"};websocket.send(JSON.stringify(e))}function toggleTimerEnable(){autoEnabled=!autoEnabled;let e={type:"auto",auto_enabled:autoEnabled};if(debug){console.log(e)}websocket.send(JSON.stringify(e))}function updateSettings(){let e;let t;let n;let o={type:"chg_settings",hours:e,duration:t,gmt_offset:n};websocket.send(JSON.stringify(o))}function closeRelay(){setRelay(true);setTimeout(setRelay,1e3,false)}function setRelay(e){let t={type:"relay",relay_status:e};console.log(t);websocket.send(JSON.stringify(t))}function clickHour(e){let t=$(e.target).text();alert(t)}$(document).ready(function(){initWebSocket();$("#masterSwitch").click(function(){toggleTimerEnable()});$("#closeRelayBtn").click(function(){closeRelay()});$(".hourBtn").click(function(e){clickHour(e)});setInterval(requestStatus,500);setInterval(requestTimingConfig,1e4)});